import { Logger } from '../shared/Logger';
import { Server } from "../Server";
import { IService } from "../Service";
import { IAuthProvider } from "../auth";
import { User } from "../realms";
export interface AuthServiceConfiguration {
    refreshTokenTtl?: number;
    accessTokenTtl?: number;
}
export declare class AuthService implements IService {
    logger: Logger;
    server: Server;
    private privateKey;
    private publicKey;
    private adminToken;
    private refreshTokenTtl;
    private accessTokenTtl;
    private cleanupInterval;
    private adminRealm;
    private tokenRevocationRealm;
    private providers;
    constructor(config?: AuthServiceConfiguration);
    addProvider(provider: IAuthProvider): void;
    getUserByProviderId(provider: string, providerId: string): User;
    createOrUpdateUser(providerId: string, provider: string, isAdmin: boolean, metadata?: {
        [key: string]: string;
    }, userId?: string): Promise<User>;
    private start(server);
    private stop();
    private authenticate(request);
    private accessToken(path, token, data, app_id?);
    private revokeToken(tokenData, req);
    private getUserById(userId, req);
    private getUserByProviderIdApi(provider, providerId, req);
    private createOrUpdateUserApi(req, providerId, provider, isAdmin, metadata?, userId?);
    private updateProviderData(providerName, userId, data, req);
    private deleteUser(userId, req);
    private pruneRevocationTokens();
    private generateUniqueId();
    private requireAdminOrUserId(req, userId?);
    private deleteUserWithUserId(userId);
}
